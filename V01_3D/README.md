# ðŸ”¥ Fire Simulation with React Three Fiber

A realistic, interactive 3D fire simulation built with React Three Fiber (R3F). This project demonstrates a particle system for rendering dynamic fire effects, complete with physics, color transitions, and post-processing glow.

The fire's "energy" is adjustable via a slider, affecting spawn rates, velocity, spread, and lifetime for a natural, flickering flameâ€”from a low ember to a roaring blaze.

---

## ðŸš€ Features

- **Particle System:** Up to 6,000 particles with position, velocity, lifetime, and color attributes.
- **Gaussian Distribution:** Used for natural spawning (tight jet at high energy, wide base at low).
- **Physics Simulation:** Buoyancy, turbulence, air drag, and random bursts for realistic motion.
- **Color Fading:** Particles transition from white/hot to red/ember based on lifetime.
- **Post-Processing:** Bloom effect for glowing embers and core.
- **Interactive Controls:** Energy slider (10â€“100%) and orbit camera.
- **Pure JS/Three.js:** No external shaders; everything in JSX and hooks.

---

## ðŸ“‚ Project Structure
`index.html`            # Vite HTML entry point (sets up the root div and loads the app) <br>
`package.json`                # Project metadata, dependencies, and npm scripts <br>
`package-lock.json`           # Exact dependency versions (generated by npm) <br>

`main.jsx`                # Entry point for React: renders <App /> into #root <br>
`App.jsx`                 # Root component: simply renders the FireSimulation <br>
`index.css`               # Global styles

`FireParticles.jsx`   # Core particle system: spawning, physics, color updates, and rendering <br>
`FireSimulation.jsx`  # Main 3D scene: Canvas setup, lighting, post-processing, UI slider, and controls <br>

`colors.js`           # Utility to compute particle color based on lifetime (alternative/unused in current version) <br>
`createParticle.js`   # Factory function for new particles with energy-based parameters (alternative version) <br>
`gaussian.js`        # Gaussian (normal) random number generator using Box-Muller transform <br>

---

## ðŸ§  Theoretical Background

This fire simulation is built on fundamental concepts from **particle systems**, **procedural animation**, **physics-based modeling**, and **information theory** (Gaussian distributions). Below is a detailed breakdown of the key ideas and why they produce a realistic flame effect.

### 1. Particle Systems for Fire Simulation

Fire cannot be modeled easily with traditional meshes because it has no fixed surface and constantly changes shape. The standard approach in computer graphics is a **particle system**:

- Thousands of short-lived particles are continuously emitted from a source (the burner).
- Each particle follows simple physical rules (velocity, acceleration, lifetime).
- Particles are rendered as small billboards or points with additive blending to create glow and overlap.

Advantages:
- Highly parallelizable and efficient on the GPU.
- Naturally produces turbulent, chaotic motion typical of flames.

In this project, up to 6,000 particles are simulated entirely on the CPU (for educational clarity) and rendered with Three.js `<points>`.

### 2. Gaussian (Normal) Distribution for Organic Spawning

Real flames are denser and hotter in the center, becoming sparser toward the edges. A **uniform random** spawn would produce a flat, unnatural cylinder shape.

Instead, particle positions are sampled from a **2D Gaussian distribution** centered on the burner:

$$ x \sim \mathcal{N}(0, \sigma_x^2), \quad z \sim \mathcal{N}(0, \sigma_z^2) $$

where the standard deviation Ïƒ is controlled by the energy level:
- High energy â†’ small Ïƒ â†’ tight, focused jet.
- Low energy â†’ large Ïƒ â†’ wide, flickering base (onion-like shape).

The Gaussian is generated using the **Box-Muller transform**:

$$ z_0 = \sqrt{-2 \ln u_1} \cos(2\pi u_2) $$

This produces natural clustering: most particles spawn near the center, creating a bright core, while fewer particles appear at the edges.

### 3. Physics and Forces

Each particle is updated every frame with the following forces:

| Force              | Purpose                                      | Implementation Details                              |
|--------------------|----------------------------------------------|-----------------------------------------------------|
| **Initial upward velocity** | Simulates hot gas rising                     | Stronger at higher energy (`2.0 + energyÂ² Ã— 10.0`)   |
| **Buoyancy (constant upward acceleration)** | Sustains rise as particles cool              | `+ (0.02 + energy Ã— 0.1) Ã— Î”t Ã— 60`                 |
| **Turbulence**     | Creates swirling, chaotic motion              | Low-frequency sine/cosine noise based on position and time |
| **Air drag**       | Slows particles over time                    | Velocity multiplied by `(1 - (0.3 + energy Ã— 0.4) Ã— Î”t)` |
| **Random bursts**  | Adds lively "flame tongues" at edges         | Rare bonus energy to outer particles                |

These simple rules combine to produce complex, emergent behavior that looks like real convection and turbulence.

### 4. Lifetime and Energy-Based Behavior

Particle lifetime is modulated by:
- Global energy level (higher energy â†’ longer life).
- Distance from center (center particles live longer â†’ dense core).
- Random variation (prevents uniform "sheets" of particles).

This creates a natural vertical gradient: bright, fast-moving core with longer trails, fading into sparse, short-lived embers at the sides.

### 5. Color Progression (Black-Body Radiation Approximation)

Flame color changes with temperature:
- Hottest regions (base/center) â†’ white/yellow.
- Cooler regions (top/edges) â†’ orange â†’ red â†’ dark.

The color is computed per particle based on **life fraction** (remaining life / initial life):

1. **>90% life**: White â†’ bright yellow (inner core).
2. **70â€“90%**: Yellow â†’ orange.
3. **40â€“70%**: Orange â†’ red.
4. **<40%**: Red â†’ dark red (dying embers).

Additional brightness fade using a parabolic curve ensures the flame is brightest in the middle and softly fades at the top and edges.

### 6. Rendering Techniques

- **Additive Blending** (`THREE.AdditiveBlending`): Overlapping bright particles create intense glow without dark seams.
- **Vertex Colors**: Each particle has its own color â†’ smooth gradients without textures.
- **Soft Particle Texture**: Radial gradient canvas texture prevents hard square edges.
- **Bloom Post-Processing**: Extracts bright areas and blurs them, simulating light scattering in the eye/camera. Key parameters:
  - `luminanceThreshold = 0.5`: Only the hottest parts bloom.
  - `mipmapBlur`: Softer, more realistic glow.

### 7. Energy Scaling and Non-Linearity

The global "energy" slider (10â€“100%) does not scale everything linearly. Most parameters use **quadratic ramping** (`energyÂ²`) to feel more natural:
- Spawn rate, upward force, and lifetime increase dramatically at high energy.
- This mimics real combustion: small increases in fuel produce disproportionately larger flames.

### Summary

By combining:
- Gaussian spawning â†’ natural density,
- Simple physics forces â†’ turbulent motion,
- Lifetime/color gradients â†’ temperature realism,
- Additive rendering + bloom â†’ visual glow,

the simulation achieves a surprisingly convincing fire effect using only a few hundred lines of JavaScript and no complex shaders.

---

## ðŸ“¦ Installation & Usage

### 1. Prerequisites
- Node.js (v18+ recommended)

### 2. Install Dependencies
```bash
npm install
```
### 3. Run Development Server
```bash
npm run dev
```

